# Contributor: Jannik Eckhardt <jannik.eckhardt2009@gmail.com>
# Maintainer: Jannik Eckhardt <jannik.eckhardt2009@gmail.com>
pkgname=ezgapi
pkgver=0.4.1
pkgrel=0
pkgdesc="EasyGuard HTTP API"
url="https://github.com/easyguard/ezg-api"
arch="all"
license="GPL-3.0-only"
depends="arp-scanner"
makedepends="cargo cargo-auditable"
checkdepends=""
source="https://github.com/easyguard/ezg-api/archive/refs/heads/main.zip
	ezgapi.initd"
builddir="$srcdir/ezg-api-main"

prepare() {
	default_prepare

	cargo fetch --target="$CTARGET" --locked
}

build() {
	cargo auditable build --frozen --release
}

check() {
	# cargo test --frozen
	:
}

package() {
	install -Dm755 "$builddir/target/release/ezg-api" "$pkgdir/usr/bin/ezg-api"
	install -Dm755 "$srcdir/ezgapi.initd" "$pkgdir/etc/init.d/ezgapi"
}

sha512sums="
7073311c56ce650ee45e5435a4537d694e7fea3eecd34dc2bda454076b547894cf80eec4a862534deba5c06e3977b281b187e7c9ec3ff698f7a2b2bdce2c957c  main.zip
4b860839b54461768eeb28712ebca269fab937ed639facdd5ae6d443ab7aa23e7a97c4cc4aa986f4de157d8be0ae7cc6057635781cbb380899f8aa2f9d2e3421  ezgapi.initd
"
